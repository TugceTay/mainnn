unit Unit1;

interface

uses
  System.SysUtils, System.Types, System.UITypes, System.Classes, System.Variants,
  System.Math, System.Math.Vectors,
  FMX.Types, FMX.Controls, FMX.Forms, FMX.Graphics, FMX.Dialogs, FMX.StdCtrls,
  FMX.Controls.Presentation, FMX.Controls3D, FMX.Objects3D,
  FMX.DAE.Importer,        // .dae importer :contentReference[oaicite:0]{index=0}
  FMX.Viewport3D, FMX.Types3D,
  FMX.Materials, FMX.MaterialSources; // LightMaterialSource

type
  TForm1 = class(TForm)
    Viewport3D1: TViewport3D;
    Camera1: TCamera;
    Light1: TLight;  // standart FMX ���k
    LightMaterialSource1: TLightMaterialSource;
    btnLoadModel: TButton;
    OpenDAEDialog: TOpenDialog;
    procedure btnLoadModelClick(Sender: TObject);
  end;

var
  Form1: TForm1;

implementation
{$R *.fmx}

procedure TForm1.btnLoadModelClick(Sender: TObject);
var
  Model: TModel3D;
  I: Integer;
begin
  if not OpenDAEDialog.Execute then
    Exit;

  Model := TModel3D.Create(Viewport3D1);
  try
    if not Model.LoadFromFile(OpenDAEDialog.FileName) then
      raise Exception.Create('DAE dosyas� y�klenemedi');

    Model.Parent := Viewport3D1;
    // Her mesh'e malzemeyi ata :contentReference[oaicite:1]{index=1}
    for I := 0 to Length(Model.MeshCollection) - 1 do
      Model.MeshCollection[I].MaterialSource := LightMaterialSource1;

    Model.Position.Point := Point3D(0, 0, 0);
    Camera1.Position.Z := -MaxValue([Model.Width, Model.Height, Model.Depth]) * 2;
    Camera1.RotationAngle.X := 20;
    Camera1.RotationCenter.Point := Point3D(0, 0, 0);
  except
    FreeAndNil(Model);
    raise;
  end;
end;

end.

